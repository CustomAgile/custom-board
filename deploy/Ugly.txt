<!DOCTYPE html>
<html>
<head>
    <title>custom-board-0.0.1</title>
    <!--  (c) 2017 CA Technologies.  All Rights Reserved. -->
    <!--  Build Date: Thu Sep 20 2018 19:43:06 GMT+0000 (UTC) -->

    <script type="text/javascript">
        var APP_BUILD_DATE = "Thu Sep 20 2018 19:43:06 GMT+0000 (UTC)";
        var CHECKSUM = 4398083069;
    </script>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>
    <!-- our highcharts (needed so that we can add patterns)
    <script type="text/javascript" src="/apps/2.1/lib/analytics/analytics-all.js"></script>
    -->


    <script type="text/javascript">
        Rally.onReady(function() {
            !function(){var a=window.Ext4||window.Ext;a.define("Rally.apps.common.RowSettingsField",{alias:"widget.rowsettingsfield",extend:"Ext.form.FieldContainer",requires:["Rally.ui.CheckboxField","Rally.ui.combobox.ComboBox","Rally.ui.plugin.FieldValidationUi","Rally.data.ModelFactory","Rally.data.wsapi.ModelBuilder"],mixins:{field:"Ext.form.field.Field"},layout:"hbox",cls:"row-settings",config:{value:void 0,isAllowedFieldFn:a.emptyFn,explicitFields:[],modelNames:["userstory","defect"],whiteListFields:[]},initComponent:function(){this.callParent(arguments),this.mixins.field.initField.call(this),this.add([{xtype:"rallycheckboxfield",name:"showRows",boxLabel:"",margin:"0",submitValue:!1,value:this.getValue().showRows,listeners:{change:function(a,b){this.down("rallycombobox").setDisabled(!b)},scope:this}},{xtype:"rallycombobox",plugins:["rallyfieldvalidationui"],name:"rowsField",margin:"0 6px",width:130,emptyText:"Choose Field...",displayField:"name",valueField:"value",disabled:"true"!==this.getValue().showRows,editable:!1,submitValue:!1,storeType:"Ext.data.Store",storeConfig:{remoteFilter:!1,fields:["name","value"],data:[]}}]),this._loadModels()},_loadModels:function(){Rally.data.ModelFactory.getModels({types:this.getModelNames(),context:this.context,success:this._onModelsRetrieved,scope:this})},_onModelsRetrieved:function(b){var c=_.uniq(a.Array.merge(this.explicitFields,this._getRowableFields(_.values(b))),"name"),d=this.down("rallycombobox");d.getStore().loadData(_.sortBy(c,"name")),d.setValue(this.getValue().rowsField),this.fireEvent("ready",this)},_getRowableFields:function(a){var b=Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(a,this.context),c=b.getFields(),d=_.filter(c,function(c){var d=c.attributeDefinition;return d&&!d.Hidden&&d.Sortable&&(b.getModelsForField(c).length===a.length&&this.isAllowedFieldFn(c)||_.contains(this.whiteListFields,c.displayName))},this);return _.map(d,function(a){return{name:a.displayName,value:a.name}})},getSubmitData:function(){var a={},b=this.down("rallycheckboxfield"),c=this.down("rallycombobox"),d=b.getValue()&&!_.isEmpty(c.getValue());return a[b.name]=d,d&&(a[c.name]=c.getValue()),a},refreshWithNewModelType:function(a){this.setModelNames([a]),this._loadModels()}})}(),function(){var a=window.Ext4||window.Ext;a.define("Rally.apps.board.Settings",{singleton:!0,requires:["Rally.ui.combobox.FieldComboBox","Rally.ui.combobox.ComboBox","Rally.ui.TextField","Rally.ui.NumberField","Rally.apps.common.RowSettingsField","Rally.data.wsapi.Filter"],getFields:function(b){return[{name:"type",xtype:"rallycombobox",shouldRespondToScopeChange:!0,context:b,storeConfig:{model:a.identityFn("TypeDefinition"),sorters:[{property:"Name"}],fetch:["DisplayName","ElementName","TypePath","Parent"],filters:[{property:"Creatable",value:!0}],autoLoad:!1,remoteSort:!1,remoteFilter:!0},displayField:"DisplayName",valueField:"TypePath",listeners:{select:function(a,b){a.fireEvent("typeselected",b[0].get("TypePath"),a.context)},ready:function(a){a.store.sort("DisplayName"),a.store.filterBy(function(a){var b=a.get("Parent"),c=b.ElementName;return _.contains(["Artifact","SchedulableArtifact","Requirement","PortfolioItem"],c)}),a.fireEvent("typeselected",a.getRecord().get("TypePath"),a.context)}},bubbleEvents:["typeselected"],readyEvent:"ready",handlesEvents:{projectscopechanged:function(a){this.refreshWithNewContext(a)}}},{name:"groupByField",fieldLabel:"Columns",xtype:"rallyfieldcombobox",readyEvent:"ready",handlesEvents:{typeselected:function(a,b){this.refreshWithNewModelType(a,b)}},listeners:{ready:function(b){b.store.filterBy(function(a){var b=a.get("fieldDefinition"),c=b.attributeDefinition;return c&&!c.ReadOnly&&!c.Hidden&&c.Constrained&&"COLLECTION"!==c.AttributeType&&(!c.AllowedValueType||"User"!==c.AllowedValueType._refObjectName)&&!_.contains(["Iteration","Release","Project"],c.Name)&&!b.isMappedFromArtifact});var c=a.Array.map(b.store.getRange(),function(a){return a.get(b.getValueField())});a.Array.contains(c,b.getValue())||b.setValue(c[0])}}},{name:"groupHorizontallyByField",xtype:"rowsettingsfield",fieldLabel:"Swimlanes",mapsToMultiplePreferenceKeys:["showRows","rowsField"],readyEvent:"ready",isAllowedFieldFn:function(a){var b=a.attributeDefinition;return(b.Custom&&(b.Constrained||"string"!==b.AttributeType.toLowerCase())||b.Constrained||_.contains(["quantity","boolean"],b.AttributeType.toLowerCase())||!b.Constrained&&"object"===b.AttributeType.toLowerCase())&&!_.contains(["web_link","text","date"],b.AttributeType.toLowerCase())&&!_.contains(["PortfolioItemType","LastResult"],b.ElementName)},handlesEvents:{typeselected:function(a,b){this.refreshWithNewModelType(a,b)}}},{name:"order",fieldLabel:"Order",xtype:"rallyfieldcombobox",readyEvent:"ready",handlesEvents:{typeselected:function(a,b){this.refreshWithNewModelType(a,b)}},listeners:{ready:function(a){a.store.filterBy(function(a){var b=a.get("fieldDefinition"),c=b.attributeDefinition;return c&&c.Sortable&&!b.isMappedFromArtifact})}},initialValue:b.getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled?"DragAndDropRank":"Rank"},{type:"query"}]}})}(),function(){var a=window.Ext4||window.Ext;a.define("Rally.apps.board.BoardApp",{extend:"Rally.app.App",alias:"widget.boardapp",requires:["Rally.ui.cardboard.plugin.FixedHeader","Rally.ui.gridboard.GridBoard","Rally.ui.gridboard.plugin.GridBoardAddNew","Rally.ui.gridboard.plugin.GridBoardInlineFilterControl","Rally.ui.gridboard.plugin.GridBoardFieldPicker","Rally.data.util.Sorter","Rally.apps.board.Settings","Rally.clientmetrics.ClientMetricsRecordable"],mixins:["Rally.clientmetrics.ClientMetricsRecordable"],helpId:287,cls:"customboard",autoScroll:!1,layout:"fit",config:{defaultSettings:{type:"HierarchicalRequirement",groupByField:"ScheduleState",showRows:!1}},launch:function(){Rally.data.ModelFactory.getModel({type:this.getSetting("type"),context:this.getContext().getDataContext()}).then({success:function(a){this.model=a,this.add(this._getGridBoardConfig())},scope:this})},_getGridBoardConfig:function(){var a=this.getContext(),b=[this.getSetting("type")],c=["Successors","Predecessors","DisplayColor"],d=["Milestones","Tags"],e={xtype:"rallygridboard",stateful:!1,toggleState:"board",cardBoardConfig:this._getBoardConfig(),plugins:[{ptype:"rallygridboardaddnew",addNewControlConfig:{stateful:!0,stateId:a.getScopedStateId("board-add-new")}},{ptype:"rallygridboardinlinefiltercontrol",inlineFilterButtonConfig:{stateful:!0,stateId:a.getScopedStateId("board-inline-filter"),modelNames:b,legacyStateIds:[a.getScopedStateId("board-owner-filter"),a.getScopedStateId("board-custom-filter-button")],filterChildren:!0,inlineFilterPanelConfig:{quickFilterPanelConfig:{defaultFields:["ArtifactSearch","Owner"],addQuickFilterConfig:{blackListFields:c,whiteListFields:d}},advancedFilterPanelConfig:{advancedFilterRowsConfig:{propertyFieldConfig:{blackListFields:c,whiteListFields:d}}}}}},{ptype:"rallygridboardfieldpicker",headerPosition:"left",boardFieldBlackList:c,modelNames:b}],context:a,modelNames:b,storeConfig:{filters:this._getFilters()},listeners:{load:this._onLoad,scope:this}};return this.getEl()&&(e.height=this.getHeight()),e},_onLoad:function(){this.recordComponentReady({miscData:{type:this.getSetting("type"),columns:this.getSetting("groupByField"),rows:this.getSetting("showRows")&&this.getSetting("rowsField")||""}})},_getBoardConfig:function(){var b={margin:"10px 0 0 0",attribute:this.getSetting("groupByField"),context:this.getContext(),cardConfig:{editable:!0,showIconMenus:!0},loadMask:!0,plugins:[{ptype:"rallyfixedheadercardboard"}],storeConfig:{sorters:Rally.data.util.Sorter.sorters(this.getSetting("order"))},columnConfig:{fields:this.getSetting("fields")&&this.getSetting("fields").split(",")||[]}};return this.getSetting("showRows")&&a.merge(b,{rowConfig:{field:this.getSetting("rowsField"),sortDirection:"ASC"}}),this._shouldDisableRanking()&&(b.enableRanking=!1,b.enableCrossColumnRanking=!1,b.cardConfig.showRankMenuItems=!1),b},getSettingsFields:function(){return Rally.apps.board.Settings.getFields(this.getContext())},_shouldDisableRanking:function(){return"task"===this.getSetting("type").toLowerCase()&&(!this.getSetting("showRows")||this.getSetting("showRows")&&"workproduct"!==this.getSetting("rowsField").toLowerCase())},_addBoard:function(){var a=this.down("rallygridboard");a&&a.destroy(),this.add(this._getGridBoardConfig())},onTimeboxScopeChange:function(a){this.callParent(arguments),this._addBoard()},_getFilters:function(){var a=[],b=this.getContext().getTimeboxScope();return this.getSetting("query")&&a.push(Rally.data.QueryFilter.fromQueryString(this.getSetting("query"))),b&&b.isApplicable(this.model)&&a.push(b.getQueryFilter()),a}})}();

               Rally.launchApp('Rally.apps.board.BoardApp', {
                   name: 'custom-board'
               });
        });
    </script>

    <style type="text/css">

.customboard {
    overflow-y: hidden;
}

    </style>

</head>
<body></body>
</html>